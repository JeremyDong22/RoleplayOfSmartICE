# 时间测试方案指南

## 概述
本应用已集成时间测试系统，支持模拟任意时间点来测试不同时段的任务和功能。系统使用时间偏移（offset）机制，确保时间持续流动，更真实地模拟实际运行场景。

## 测试系统特点

### 1. 全局时间同步
- 所有角色（Manager、Chef）共享同一测试时间
- 支持多标签页/多窗口同步
- 测试时间持续流动（不是固定在某一点）

### 2. 使用方法

#### 通过UI设置测试时间
1. 点击右上角时间旁边的编辑图标 ✏️
2. 在弹出的对话框中设置目标日期和时间
3. 点击"设置时间"按钮
4. 系统会显示"测试模式"标签，点击❌可退出测试模式

#### 时间持续性
- 设置测试时间后，时间会继续正常流动
- 例如：设置为 10:00:00 后，会继续走到 10:00:01、10:00:02...
- 这确保了倒计时、任务超时等功能正常工作

## 关键测试场景

### 1. 开店测试（10:00-10:30）
```
测试时间：10:00
测试内容：
- 日常任务重置
- 等待状态自动解除
- 开店任务显示
```

### 2. 午市收市测试（14:00-14:30）
```
测试时间：14:00
测试内容：
- 收市任务显示
- 任务完成状态跟踪
- 任务超时提醒
```

### 3. 预打烊测试（21:00-21:30）
```
测试时间：21:00
测试内容：
- Manager：右滑卡片功能
- Chef：完成所有任务后的红色按钮
- 未完成任务收集
```

### 4. 闭店测试（21:30-22:00）
```
测试时间：21:30
Manager专属测试：
- 自动进入闭店期（如果已右滑）
- 闭店任务显示
- 完成后进入等待状态
```

### 5. 跨日测试
```
测试流程：
1. 设置时间为 21:50（闭店期）
2. 完成所有任务，进入等待状态
3. 设置时间为第二天 10:05
4. 验证任务重置和新一天开始
```

## 完整测试流程

### 快速功能测试（5分钟）
1. **开店期**：设置 10:15 → 查看任务 → 完成1-2个任务
2. **预打烊**：设置 21:15 → Manager右滑/Chef完成任务
3. **等待状态**：验证进入等待状态
4. **新一天**：设置第二天 10:05 → 验证任务重置

### 完整业务测试（30分钟）
1. **清理数据**：点击"重置任务"按钮
2. **开店期**（10:00）
   - 召开早会
   - 设备检查
   - 卫生验收
3. **午市营业**（12:00）
   - 查看任务提醒
   - 完成部分任务
4. **午市收市**（14:00）
   - 收市清洁
   - 营业款核对
5. **晚市准备**（17:00）
   - 召开午会
   - 物资准备
6. **预打烊**（21:00）
   - Manager：右滑进入闭店
   - Chef：完成任务后点红色按钮
7. **验证跨日**（第二天 10:00）

## 注意事项

1. **数据持久化**
   - 测试模式下的任务完成状态会保存
   - 使用"重置任务"清理测试数据

2. **浏览器刷新**
   - 测试时间在刷新后保持
   - 任务状态也会保持

3. **多角色测试**
   - 可以开多个标签页分别登录不同角色
   - 时间会自动同步

4. **退出测试模式**
   - 点击"测试模式"标签的❌
   - 或在时间编辑对话框中恢复真实时间

## 常见问题

### Q: 设置时间后任务没有更新？
A: 确保设置的时间跨越了时段边界（如从 9:59 到 10:00）

### Q: 倒计时显示不正确？
A: 测试时间是持续流动的，倒计时会正常工作

### Q: 如何测试任务超时？
A: 设置时间到任务结束时间附近，等待几秒即可看到超时状态

### Q: 测试数据如何清理？
A: 使用时间编辑对话框中的"重置任务"按钮

## 测试检查清单

- [ ] 各时段任务正确显示
- [ ] 任务完成状态正确保存
- [ ] Manager右滑功能正常
- [ ] Chef红色按钮功能正常  
- [ ] 等待状态正确显示和解除
- [ ] 跨日任务重置正常
- [ ] 任务超时提醒正常
- [ ] 完成率计算正确
- [ ] 多角色时间同步正常